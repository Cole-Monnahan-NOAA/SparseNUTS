<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Implementing parameter transformations in SNUTS • SparseNUTS</title>
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><link href="../extra.css" rel="stylesheet">
<meta property="og:title" content="Implementing parameter transformations in SNUTS">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">SparseNUTS</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">0.0.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../articles/SparseNUTS.html">Get started</a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html">Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true">Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/advanced-usage.html">Advanced usage</a></li>
    <li><a class="dropdown-item" href="../articles/Implementing-bounds.html">Implementing parameter transformations in SNUTS</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><form class="form-inline" role="search">
 <input class="form-control" type="search" name="search-input" id="search-input" autocomplete="off" aria-label="Search site" placeholder="Search for" data-search-index="../search.json">
</form></li>
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/noaa-afsc/SparseNUTS/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">

      <h1>Implementing parameter transformations in SNUTS</h1>
                        <h4 data-toc-skip class="author">Cole C.
Monnahan</h4>
            
            <h4 data-toc-skip class="date">2026-01-16</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/noaa-afsc/SparseNUTS/blob/main/vignettes/Implementing-bounds.Rmd" class="external-link"><code>vignettes/Implementing-bounds.Rmd</code></a></small>
      <div class="d-none name"><code>Implementing-bounds.Rmd</code></div>
    </div>

    
    
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://noaa-afsc.github.io/SparseNUTS">SparseNUTS</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/kaskr/RTMB" class="external-link">RTMB</a></span><span class="op">)</span></span></code></pre></div>
<p>One major difference with the Stan langauge is that SNUTS does not
natively handle parameter transformations such as box constraints.
Instead, the analyst must do this manually in the model code, and
include a Jacobian manually as well.
<code>StanEstimator::stan_sample</code> has arguments for lower and
upper bounds of parameters, but this functionality is not compatible
with SNUTS because the decorrelation happens prior to applying the
transformations. In other words, the bounds would be meaningless because
the parameters they are associated with are decorrelated.</p>
<p>This article demonstrates how to implement parameter transformations
in RTMB for strictly positive parameters (e.g., variances) as well as a
box constraint with a lower and upper bound (e.g., a probability).</p>
<p><a href="https://mc-stan.org/docs/stan-users-guide/reparameterization.html#change-of-variables-vs.-transformations" class="external-link uri">https://mc-stan.org/docs/stan-users-guide/reparameterization.html#change-of-variables-vs.-transformations</a>
“A transformation samples a parameter, then transforms it, whereas a
change of variables transforms a parameter, then samples it. Only the
latter requires a Jacobian adjustment.”</p>
<p><a href="https://mc-stan.org/docs/reference-manual/transforms.html#absolute-derivative-of-the-lower-and-upper-bounds-inverse-transform" class="external-link uri">https://mc-stan.org/docs/reference-manual/transforms.html#absolute-derivative-of-the-lower-and-upper-bounds-inverse-transform</a></p>
<p><a href="https://mc-stan.org/docs/reference-manual/transforms.html#absolute-derivative-of-the-lower-and-upper-bounds-inverse-transform" class="external-link uri">https://mc-stan.org/docs/reference-manual/transforms.html#absolute-derivative-of-the-lower-and-upper-bounds-inverse-transform</a></p>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Cole Monnahan.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

    </footer>
</div>





  </body>
</html>
